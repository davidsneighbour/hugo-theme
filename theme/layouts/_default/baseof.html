<!DOCTYPE html>
{{- partials.Include "init.html" . -}}
{{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "setup" "context" . ) -}}
{{- $sitelang := site.LanguageCode | compare.Default "en-US" -}}
<html lang="{{- $sitelang -}}" data-bs-theme="{{- site.Params.dnb.theme.colorscheme -}}">
  <head>
    {{- /* loading head module
           see https://github.com/davidsneighbour/hugo-modules/tree/main/modules/head */ -}}
    {{- partials.Include "head.html" . -}}
  </head>
  {{- $classes := partials.IncludeCached "func/getBodyClasses.html" . . -}}
  <body class="{{- $classes -}}" id="top">
    <a class="visually-hidden-focusable skip-to-main-link" href="#maincontent">
      {{- lang.Translate "theme.skip_to_content" -}}
    </a>
    <span id="top" class="d-none" aria-hidden="true"></span>
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "body-start" "context" . ) -}}
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-pre" "context" . ) -}}
    {{- partials.Include "header/topnavigation.html" . -}}
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-post" "context" . ) -}}
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "body-pre-main" "context" . ) -}}
    {{- $pagefindMarker := "" -}}
    {{- if in (collections.Slice "page") page.Kind }}
      {{- $pagefindMarker = "data-pagefind-body" -}}
    {{- end -}}
    <main id="maincontent" {{ $pagefindMarker | safeHTMLAttr }} tabindex="-1">
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "body-main-start" "context" . ) -}}
      {{- block "main" . -}}{{- end -}}
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "body-main-end" "context" . ) -}}
    </main>
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "body-post-main" "context" . ) -}}
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "footer-pre" "context" . ) -}}
    <footer id="footer" class="p-7">
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "footer-start" "context" . ) -}}
      <div class="widgets container text-center">
        <h2 class="d-none invisible">Footer Items</h2>
        {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "footer-widgets-start" "context" . ) -}}
        {{- with site.Params.subscription -}}
          {{- partials.IncludeCached "footer/newsletter.html" site.Params.subscription site.Params.subscription -}}
        {{- end -}}
        {{- with site.Menus.footer -}}
          <div class="widget footer-navigation">
            <h3 class="fs-6 my-5 fw-bold text-uppercase">{{ lang.Translate "theme.footer_menu_header" }}</h3>
            <ul class="mb-0 list-inline">
              {{- range . -}}
                <li class="px-2 list-inline-item">
                  <a href="{{- .URL | absLangURL -}}">
                    {{- with .Params.bsicon }}
                      {{ $options := dict "icon" . "size" "1.5em" "class" "me-2" }}
                      {{ partials.Include "icon.html" $options }}
                    {{ end -}}
                    {{- .Name -}}
                  </a>
                </li>
              {{- end -}}
            </ul>
          </div>
        {{- end -}}
        {{- with site.Params.dnb.social -}}
          {{- /*

            ```toml
            [dnb.social.sharebuttons]
            networks = ["slug1", "slug2", ...]
            icons = true
            sharetext = false

            [dnb.social.network.slug1]
            url = ""
            icon = "bootstrap icon"
            label = ""

            [dnb.social.network.slug2]
            url = ""
            icon = "bootstrap icon"
            label = ""
            ```

          */ -}}
          {{- $order := collections.Slice -}}
          {{- $networks := .network | compare.Default collections.Dictionary -}}
          {{- $sharebuttons := .sharebuttons | compare.Default collections.Slice -}}
          {{- $config := site.Params.dnb.social.sharebuttons -}}
          {{- with $sharebuttons -}}
            {{- $order = .networks -}}
          {{- else -}}
            {{- range $key, $item := $networks -}}
              {{- $order = $order | append $key -}}
            {{- end -}}
          {{- end -}}
          <div class="widget social-media">
            <h3 class="fs-6 my-5 fw-bold text-uppercase">{{- lang.Translate "theme.connect-on-social" -}}</h3>
            <div class="container">
              <div class="row row-cols-4 row-cols-md-6 justify-content-md-center">
                {{- range $order -}}
                  {{- $network := index $networks . -}}
                  <div class="col text-center">
                    <a
                      href="{{- $network.url -}}"
                      aria-label="{{- $network.label -}}"
                      class="icon-{{ $network.icon }} p-2 d-inline-block"
                      title="{{- $network.label -}}">
                      {{- with ($config.icons | compare.Default true) -}}
                        {{- if eq . true -}}
                          {{- $options := dict "icon" $network.icon "class" "c-20" "width" "32" "height" "32" -}}
                          {{- partials.Include "icon.html" $options -}}
                        {{- end -}}
                      {{- end -}}
                      <span class="visually-hidden">
                      {{- with ($config.sharetext | compare.Default false) -}}
                        {{- if eq . true -}}
                          {{- $network.label -}}
                        {{- end -}}
                      {{- end -}}
                      </span>
                    </a>
                  </div>
                {{- end -}}
                </div>
              </div>
            </div>
          </div>
        {{- end -}}
        <div class="d-flex flex-column flex-md-row justify-content-center mt-6 column-gap-3 row-gap-2">
          <div>
            {{- $year := partials.IncludeCached "func/getYear.html" . -}}
            {{- fmt.Printf (lang.Translate "theme.copyright-text") (string $year) | .RenderString | safeHTML -}}
          </div>
          <div class="d-none d-md-inline-block vr"></div>
          <div x-data="versionData">
            {{ lang.Translate "theme.version" }}
            <a :href="url" class="version" x-text="version" target="_blank"></a>
          </div>
        </div>
        {{- if hugo.IsServer -}}
          {{- /* debugging area */ -}}
        {{- end -}}
        {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "footer-widgets-end" "context" . ) -}}
      </div>
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "footer-end" "context" . ) -}}
    </footer>
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "footer-post" "context" . ) -}}
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "body-end-pre-script" "context" . ) -}}
    {{- $options := site.Params.dnb.theme.jsbuild.options -}}
    {{- $scripts := resources.Get "js/script.js" |
          js.Build (
            collections.Merge $options (collections.Dictionary "targetPath" "assets/js/script.js")
          ) | fingerprint "sha512" -}}
    <script src="{{- $scripts.Permalink -}}" async defer integrity="{{- $scripts.Data.Integrity -}}"></script>
    {{- with resources.Get "js/main.js" -}}
      {{- $script := . | resources.ExecuteAsTemplate "plugins.js" . -}}
      {{- $script = $script |
            js.Build (
              collections.Merge $options (collections.Dictionary "targetPath" "assets/js/main.js")
            ) | fingerprint "sha512" -}}
      <script src="{{- $script.Permalink -}}" async defer integrity="{{- $script.Data.Integrity -}}"></script>
    {{- else -}}
      {{- partials.Include "debug.html" (dict
            "message" "[modder] js/main.js missing, module modder is probably not configured properly"
            "context" .
            "severity" "warn"
            "level" 8
      ) -}}
    {{- end -}}
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "body-end" "context" . ) -}}
    {{- partials.Include "footer/service-worker.html" . -}}
    <a href="javascript:history.back();" data-hotkey="k+ArrowLeft" class="d-none">Back</a>
    <a href="javascript:history.forward();" data-hotkey="k+ArrowRight" class="d-none">Forward</a>
    <click-effect style="--click-spark-color: #ff4359;"></click-spark>
  </body>
</html>
{{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "teardown" "context" . ) -}}
